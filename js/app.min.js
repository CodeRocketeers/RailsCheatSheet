"use strict";var app=angular.module("App",["ngRoute"]);app.config(["$routeProvider",function(e){e.when("/",{controller:"sheetsController",templateUrl:"pages/content.html"}).when("/contribute",{templateUrl:"pages/contribute.html"}).when("/cheatsheet/:id/:title",{controller:"detailController",templateUrl:"pages/content.html"}).otherwise({redirectTo:"/"})}]),app.service("dataLoaderService",["$http",function(e){this.Load=function(){var t=Date.now();return e.get("datasource.json?v="+t)}}]),app.service("resultService",function(){this.setPromise=function(e){this.promise=e},this.getPromise=function(){return this.promise}}),app.controller("sheetsController",["$scope","dataLoaderService","resultService",function(e,t,r){function n(){e.sheets=null,e.currentPage=0,e.pageSize=5,e.pages=[];var n=t.Load();r.setPromise(n),n.then(function(t){e.sheets=a(t.data.sort(function(e,t){return t.id-e.id})),e.pages=[];for(var r=Math.ceil(e.sheets.length/e.pageSize),n=0;n<r;n++)e.pages.push(n)})}function a(t){if(null==e.category)return t;var r=[];return angular.forEach(t,function(t){angular.forEach(t.categories,function(n){n==e.category&&r.push(t)})}),r}e.category=null,e.isDetail=!1,e.detailPath="cheatsheet",e.setCurrentPage=function(t){t<0?t=0:t>e.pages.length-1&&(t=e.pages.length-1),e.currentPage=t},e.setCategory=function(t){e.category=t,n()},e.filterSelectedCategory=function(t){return null==e.category||t.name==e.category},e.urlNormalize=function(e){return e.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")},n()}]),app.controller("detailController",["$scope","$routeParams","dataLoaderService","resultService",function(e,t,r,n){function a(e,t){var r=[],n=!0;return angular.forEach(e,function(e){n&&e.id==t&&(r.push(e),n=!1)}),r}e.categories=null,e.isDetail=!0,e.filterSelectedCategory=function(t){var r=!1;if(null!=e.categories){var n=!0;angular.forEach(e.categories,function(e){n&&e==t.name&&(r=!0,n=!1)})}return r},function(){e.sheets=null,e.currentPage=0,e.pageSize=5,e.pages=[0];var o=r.Load();n.setPromise(o),o.then(function(r){e.sheets=a(r.data,t.id),e.sheets.length>0&&(e.categories=e.sheets[0].categories)})}()}]),app.controller("categoriesController",["$scope","resultService",function(e,t){function r(e){var t=[];return angular.forEach(e,function(e){angular.forEach(e.categories,function(e){for(var r=!1,n=0;n<t.length;n++)t[n].name==e&&(t[n].count++,r=!0);r||t.push({name:e,count:1})})}),t}e.categories=null,e.totalCount=0,t.getPromise().then(function(t){e.totalCount=t.data.length,e.categories=r(t.data)})}]),app.directive("pagination",function(){return{restrict:"E",templateUrl:"directives/pagination.html",link:function(e,t,r){}}}),app.filter("html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),app.filter("orDefaultAvatar",function(){return function(e){return""!=e?e:"images/avatar.jpg"}});
