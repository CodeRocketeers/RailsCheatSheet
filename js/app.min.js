"use strict";var app=angular.module("App",["ngRoute"]);app.config(["$routeProvider",function(a){a.when("/",{controller:"sheetsController",templateUrl:"pages/content.html"}).when("/contribute",{templateUrl:"pages/contribute.html"}).when("/cheatsheet/:id/:title",{controller:"detailController",templateUrl:"pages/content.html"}).otherwise({redirectTo:"/"})}]),app.service("dataLoaderService",["$http",function(a){this.Load=function(){return a.get("datasource.json")}}]),app.service("resultService",function(){this.setPromise=function(a){this.promise=a},this.getPromise=function(){return this.promise}}),app.controller("sheetsController",["$scope","dataLoaderService","resultService",function(a,b,c){function d(){a.sheets=null,a.currentPage=0,a.pageSize=5,a.pages=[];var d=b.Load();c.setPromise(d),d.then(function(b){a.sheets=e(b.data.sort(function(a,b){return b.id-a.id})),a.pages=[];for(var c=Math.ceil(a.sheets.length/a.pageSize),d=0;d<c;d++)a.pages.push(d)})}function e(b){if(null==a.category)return b;var c=[];return angular.forEach(b,function(b){angular.forEach(b.categories,function(d){d==a.category&&c.push(b)})}),c}a.category=null,a.isDetail=!1,a.detailPath="cheatsheet",a.setCurrentPage=function(b){b<0?b=0:b>a.pages.length-1&&(b=a.pages.length-1),a.currentPage=b},a.setCategory=function(b){a.category=b,d()},a.filterSelectedCategory=function(b){return null==a.category||b.name==a.category},a.urlNormalize=function(a){return a.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")},d()}]),app.controller("detailController",["$scope","$routeParams","dataLoaderService","resultService",function(a,b,c,d){function e(){a.sheets=null,a.currentPage=0,a.pageSize=5,a.pages=[0];var e=c.Load();d.setPromise(e),e.then(function(c){a.sheets=f(c.data,b.id),a.sheets.length>0&&(a.categories=a.sheets[0].categories)})}function f(a,b){var c=[],d=!0;return angular.forEach(a,function(a){d&&a.id==b&&(c.push(a),d=!1)}),c}a.categories=null,a.isDetail=!0,a.filterSelectedCategory=function(b){var c=!1;if(null!=a.categories){var d=!0;angular.forEach(a.categories,function(a){d&&a==b.name&&(c=!0,d=!1)})}return c},e()}]),app.controller("categoriesController",["$scope","resultService",function(a,b){function c(a){var b=[];return angular.forEach(a,function(a){angular.forEach(a.categories,function(a){for(var c=!1,d=0;d<b.length;d++)b[d].name==a&&(b[d].count++,c=!0);c||b.push({name:a,count:1})})}),b}a.categories=null,a.totalCount=0,b.getPromise().then(function(b){a.totalCount=b.data.length,a.categories=c(b.data)})}]),app.directive("pagination",function(){return{restrict:"E",templateUrl:"directives/pagination.html",link:function(a,b,c){}}}),app.filter("html",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),app.filter("orDefaultAvatar",function(){return function(a){return""!=a?a:"images/avatar.jpg"}});